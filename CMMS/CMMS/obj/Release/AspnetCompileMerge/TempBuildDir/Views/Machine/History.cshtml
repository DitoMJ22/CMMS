@model CMMS.Models.MachineModel
@using CMMS.Models
@using System.Globalization

@{
    Layout = "~/Views/Shared/LayoutPage.cshtml";
    MaintenanceCorrective _maintenanceCorrective = new MaintenanceCorrective();
    User _user = new User();
    List<MaintenanceCorrectiveModel> maintenanceCorrectiveModels = _maintenanceCorrective.getAllWOCMachine(Model.no_asset);
}

<nav class="page-breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item">Master</li>
        <li class="breadcrumb-item" aria-current="page"><a href="@Url.Action("View", "Machine")">Machine</a></li>
        <li class="breadcrumb-item active" aria-current="page">Detail Machine</li>
    </ol>
</nav>

<div class="row">
    <div class="col-md-12 grid-margin stretch-card">
        <div class="card">
            <div class="card-body">
                <ul class="nav nav-tabs">
                    <li class="nav-item">
                        <a class="nav-link" href="@Url.Action("Detail", "Machine", new { id = Model.no_asset })">Detail</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link " href="@Url.Action("Sparepart", "Machine", new { id = Model.no_asset })">Sparepart</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="@Url.Action("History", "Machine", new { id = Model.no_asset })">History</a>
                    </li>
                </ul>

                <div class="table-responsive my-3">
                    <table id="dataTableExample" class="table table-sm ">
                        <thead class="thead-light">
                            <tr class="text-center">
                                <th scope="col" class="text-left" style="width:35px;">#</th>
                                <th scope="col">No. Work Order</th>
                                <th scope="col">Schedule Date</th>
                                <th scope="col">Finished Date</th>
                                <th scope="col">Maintenance By</th>
                                <th scope="col">Cost</th>
                                <th scope="col">Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            @{ int i = 0;}
                            @foreach (var item in maintenanceCorrectiveModels)
                            {
                                i++;
                                <tr>
                                    <th scope="row">@i</th>
                                    <td>@item.id_woc</td>
                                    <td>@item.request_date</td>
                                    @if (item.finish_date == "01-01-1753")
                                    {
                                        <td></td>
                                    }
                                    else
                                    {
                                        <td>@item.finish_date</td>
                                    }
                                    <td>@_user.getData(item.maintenance_by).name</td>
                                    <td>@string.Format(CultureInfo.GetCultureInfo("id-ID"), "{0:C2}", item.cost)</td>
                                    <td>@item.status</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function closemodal(value) {
        $(value).modal('hide');
    }
    function sendvalue(value) {
        var explode = value.split("-");
        document.getElementById("id_sparepart").value = explode[0];
        document.getElementById("name_sparepart").value = explode[1];
        $(explode[2]).modal('hide');
    }
</script>
